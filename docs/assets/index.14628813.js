var e=Object.defineProperty,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n,i=(e,i)=>{for(var s in i||(i={}))r.call(i,s)&&o(e,s,i[s]);if(t)for(var s of t(i))n.call(i,s)&&o(e,s,i[s]);return e};import{r as s,R as l,a}from"./vendor.c61d7abd.js";const c=e=>{let t=[];for(let r=0;r<e;r++)t.push(i({},{x:Math.floor(370*Math.random()),y:-Math.floor(200*Math.random()),isOver:!1,width:30,height:36,boomIndex:0,ifDel:!1,hp:3}));return t};function u(){let e=0;const t=s.exports.useRef(null),r=s.exports.useRef({isLeft:!1,isTop:!1,isRight:!1,isBottom:!1}),n=s.exports.useRef({x:0,y:0,width:30,height:36,boomIndex:0,isOver:!1,ifDel:!1,hp:0});let o=[];const i=c(10),a=()=>null==n?void 0:n.current,u=s.exports.useMemo((()=>{const e=new Image;return e.src="./assets/plane.f45a54ab.png",e}),[]),d=s.exports.useMemo((()=>{const e=new Image;return e.src="./assets/background.2072d858.png",e}),[]),h=s.exports.useMemo((()=>{const e=new Image;return e.src="./assets/enemy.bc3013b4.png",e}),[]),m=s.exports.useMemo((()=>{const e=new Image;return e.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAVCAYAAACUhcTwAAABpUlEQVR42mWSyytEYRjGn5QVW0t/gGJlr1mIc84sLJQkklgI/4PZSzGXwsJKJElCmHLZaHJJGlJnch+McStyK5fjeb/zpsGp33lnvvf53u/53vMC+sSCKInYOCUrEQftg+XIx9+nP4hSJkcpWiCJnioU/CQjFjq42Be10Mw4TL5IhuvdYRtFvsjGPgVrURsj/P3E+Mj4TlxWbokFUIiwhV4uDJFnEZErJtfJpGyIOmgDXwOafCMHJE6myJ2IeGQX+Lrhwgd37jDOkEVyRu7JpRwpnh7ILpmTKtx9zPgqx9LrMk+qEVGCvuZlQSt45JpMk6TcGiw3yz9L5EIFGVabIFvii/kGqI8XFZwb076/tNhgpXoYc74grUdskkPpHeMtPXVCBSd6KxGkjD8HR5KjqElE20pKfazmXoCiChElSVbNx3USPG3FHrFhbuNfP66+pILLJm+Y7+igVkRjekTadN5vrKvT4HEaWiHNkl3m8/hmXZ2CT7PBQgAygbEqFFMQM83zK2RpuI5rZb+GL1yNSp0Gj59pPBRC3r/xlSmUpJlxC425uW+8/A4iw+qfOQAAAABJRU5ErkJggg==",e}),[]),p=s.exports.useMemo((()=>{const e=new Image;return e.src="./assets/boom.f528a87b.png",e}),[]),v=(e,t)=>{const r=e.x,n=e.x+e.width,o=e.y,i=e.y+e.height,s=t.x,l=t.x+t.width,a=t.y,c=t.y+t.height;return!(n<s||r>l||o>c||i<a)},g=(e,t,r,n,o)=>{e.beginPath(),e.lineWidth=3,e.strokeStyle="white",e.lineTo(t,r-5),e.lineTo(t+n,r-5),e.stroke(),e.closePath(),e.beginPath(),e.lineWidth=3,e.strokeStyle="green",e.lineTo(t,r-5),e.lineTo(t+n*o,r-5),e.stroke(),e.closePath()},y=e=>{(()=>{if(i.length<10){const e=10-i.length;i.push(...c(e))}i.forEach((e=>{e.y=(null==e?void 0:e.y)+1,e.y>400+e.height&&(e.ifDel=!0,e.isOver=!0)}))})();const t=a();for(let r=0;r<(null==i?void 0:i.length);r++){const n=i[r];for(let e=0;e<(null==o?void 0:o.length);e++){const t=o[e];(null==n?void 0:n.isOver)||(null==t?void 0:t.isOver)||!v(t,n)||(n.hp=n.hp-1,t.isOver=!0,n.hp<=0&&(n.isOver=!0))}if(!(null==n?void 0:n.isOver)&&v(t,n)&&(n.isOver=!0),null==n?void 0:n.isOver){if(null==n?void 0:n.ifDel){i.splice(r,1),r--;continue}e.drawImage(p,64*(null==n?void 0:n.boomIndex),0,64,64,null==n?void 0:n.x,null==n?void 0:n.y,null==n?void 0:n.width,null==n?void 0:n.height),n.boomIndex=n.boomIndex+1,n.boomIndex>=14&&(n.ifDel=!0)}else g(e,null==n?void 0:n.x,null==n?void 0:n.y,null==n?void 0:n.width,(null==n?void 0:n.hp)/3),e.drawImage(h,null==n?void 0:n.x,null==n?void 0:n.y,null==n?void 0:n.width,null==n?void 0:n.height)}},w=()=>{const i=(()=>{const e=null==t?void 0:t.current;return null==e?void 0:e.getContext("2d")})();i&&((e=>{null==e||e.clearRect(0,0,400,400)})(i),i.drawImage(d,0,0,400,400),y(i),(e=>{const{isLeft:t,isTop:o,isRight:i,isBottom:s}=r.current,l=null==n?void 0:n.current;t&&(l.x=l.x-4,l.x<0&&(l.x=0)),o&&(l.y=l.y-4,l.y<0&&(l.y=0)),i&&(l.x=l.x+4,l.x>370&&(l.x=370)),s&&(l.y=l.y+4,l.y>364&&(l.y=364)),e.drawImage(u,l.x,l.y,l.width,l.height)})(i),(t=>{const{x:r,y:n}=a();o.forEach((e=>{e.y=e.y+-5})),o=o.filter((e=>e.y>-5||!(null==e?void 0:e.isOver))),e%3==0&&o.push({x:r+15-1.5,y:n-5,width:3,height:5,isOver:!1,ifDel:!1,boomIndex:0,hp:0}),o.forEach((e=>{t.drawImage(m,e.x,e.y,3,5)})),e++})(i))},f=()=>{const e=[u,d,h,m,p];return Promise.all(e.map((e=>new Promise(((t,r)=>{(null==e?void 0:e.complete)?t():e.onload=()=>{t()}}))))).then((()=>!0)).catch((()=>!1))};return s.exports.useEffect((()=>{const e=()=>{requestAnimationFrame((async()=>{await f()&&w(),e()}))};(async()=>{const e=n.current;e.x=185,e.y=364})(),e()}),[w,f]),s.exports.useEffect((()=>{const e=async e=>{switch(null==e?void 0:e.key){case"ArrowLeft":r.current.isLeft=!0;break;case"ArrowUp":r.current.isTop=!0;break;case"ArrowRight":r.current.isRight=!0;break;case"ArrowDown":r.current.isBottom=!0}},t=e=>{switch(null==e?void 0:e.key){case"ArrowLeft":r.current.isLeft=!1;break;case"ArrowUp":r.current.isTop=!1;break;case"ArrowRight":r.current.isRight=!1;break;case"ArrowDown":r.current.isBottom=!1}};return document.addEventListener("keydown",e),document.addEventListener("keyup",t),()=>{document.removeEventListener("keydown",e),document.removeEventListener("keyup",t)}}),[]),l.createElement("canvas",{ref:t,width:400,height:400},"您的浏览器不支持canvas")}a.render(l.createElement(l.StrictMode,null,l.createElement(u,null)),document.getElementById("root"));
